<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best RolePlay - Loja</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: white;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(139, 69, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(139, 69, 255, 0.3);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.8rem;
            font-weight: bold;
            color: #8b45ff;
            text-shadow: 0 0 10px rgba(139, 69, 255, 0.5);
        }

        .logo-img {
            width: 40px;
            height: 40px;
            filter: drop-shadow(0 0 10px rgba(139, 69, 255, 0.5));
        }

        .discord-login {
            background: linear-gradient(45deg, #7289da, #5865f2);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .discord-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(114, 137, 218, 0.4);
        }

        .user-info {
            display: none;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #8b45ff;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 2rem;
            background: radial-gradient(circle at center, rgba(139, 69, 255, 0.2), transparent 70%);
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #8b45ff, #da70d6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(139, 69, 255, 0.5);
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 2rem;
        }

        /* Products Grid */
        .products-section {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #8b45ff;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: rgba(139, 69, 255, 0.1);
            border: 1px solid rgba(139, 69, 255, 0.3);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(139, 69, 255, 0.3);
            border-color: #8b45ff;
        }

        .product-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #8b45ff;
        }

        .product-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #da70d6;
        }

        .product-description {
            opacity: 0.8;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .product-price {
            font-size: 2rem;
            font-weight: bold;
            color: #8b45ff;
            margin-bottom: 1.5rem;
        }

        .buy-button {
            background: linear-gradient(45deg, #8b45ff, #da70d6);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
        }

        .buy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 69, 255, 0.4);
        }

        .buy-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.3);
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
            border-top: 1px solid rgba(139, 69, 255, 0.3);
        }

        /* Cart */
        .cart {
            position: fixed;
            top: 50%;
            right: -400px;
            transform: translateY(-50%);
            width: 350px;
            background: rgba(26, 26, 46, 0.95);
            border: 1px solid rgba(139, 69, 255, 0.3);
            border-radius: 15px;
            padding: 2rem;
            transition: right 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .cart.open {
            right: 20px;
        }

        .cart-toggle {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: #8b45ff;
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 1001;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(139, 69, 255, 0.2);
        }

        .cart-total {
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 1rem;
            color: #8b45ff;
        }

        /* Payment Dashboard */
        .payment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .payment-modal.active {
            display: flex;
        }

        .payment-dashboard {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid #8b45ff;
            border-radius: 20px;
            padding: 3rem;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            box-shadow: 0 20px 60px rgba(139, 69, 255, 0.3);
        }

        .payment-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #8b45ff;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .payment-close:hover {
            background: rgba(139, 69, 255, 0.2);
        }

        .payment-title {
            font-size: 2rem;
            color: #8b45ff;
            margin-bottom: 1rem;
            text-shadow: 0 0 20px rgba(139, 69, 255, 0.5);
        }

        .payment-summary {
            background: rgba(139, 69, 255, 0.1);
            border: 1px solid rgba(139, 69, 255, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .payment-items {
            text-align: left;
            margin-bottom: 1rem;
        }

        .payment-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(139, 69, 255, 0.2);
        }

        .payment-total {
            font-size: 1.5rem;
            font-weight: bold;
            color: #da70d6;
            border-top: 2px solid #8b45ff;
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .pix-section {
            background: rgba(0, 255, 127, 0.1);
            border: 1px solid rgba(0, 255, 127, 0.3);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .pix-title {
            font-size: 1.5rem;
            color: #00ff7f;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .pix-code {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff7f;
            border-radius: 10px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
            color: #00ff7f;
            margin: 1rem 0;
            word-break: break-all;
        }

        .pix-qr {
            width: 200px;
            height: 200px;
            background: white;
            border-radius: 10px;
            margin: 1rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-size: 0.8rem;
        }

        .copy-button {
            background: linear-gradient(45deg, #00ff7f, #32cd32);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }

        .copy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 127, 0.4);
        }

        .payment-instructions {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: left;
        }

        .payment-instructions h4 {
            color: #ffc107;
            margin-bottom: 1rem;
        }

        .payment-instructions ol {
            color: #fff;
            opacity: 0.8;
            padding-left: 1.5rem;
        }

        .payment-instructions li {
            margin-bottom: 0.5rem;
        }
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            .nav {
                padding: 0 1rem;
            }
            
            .logo {
                font-size: 1.4rem;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <script src="discord-auth.js"></script>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="logo">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iMjAiIGZpbGw9IiM4YjQ1ZmYiLz4KPHN2ZyB4PSI4IiB5PSI4IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSI+CjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0wIDE4Yy00LjQxIDAtOC0zLjU5LTgtOHMzLjU5LTggOC04IDggMy41OSA4IDgtMy41OSA4LTggOHoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMiA2djZsNC0yLTQtNHoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo8L3N2Zz4K" alt="Best RolePlay" class="logo-img">
                Best RolePlay
            </div>
            <div class="auth-section">
                <button class="discord-login" id="discordLogin">
                    <span>🎮</span> Entrar com Discord
                </button>
                <div class="user-info" id="userInfo">
                    <img class="user-avatar" id="userAvatar" src="" alt="Avatar">
                    <span id="userName"></span>
                    <button onclick="logout()">Sair</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <h1>Best RolePlay Store</h1>
        <p>Os melhores produtos para sua experiência de roleplay</p>
    </section>

    <!-- Products Section -->
    <section class="products-section">
        <h2 class="section-title">Nossos Produtos</h2>
        <div class="products-grid" id="productsGrid">
            <!-- Products will be generated by JavaScript -->
        </div>
    </section>

    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
        <div class="payment-dashboard">
            <button class="payment-close" onclick="closePaymentModal()">✕</button>
            
            <h2 class="payment-title">💳 Finalizar Compra</h2>
            
            <div class="payment-summary">
                <div class="payment-items" id="paymentItems"></div>
                <div class="payment-total" id="paymentTotal"></div>
            </div>
            
            <div class="pix-section">
                <div class="pix-title">
                    📱 Pagamento via PIX
                </div>
                
                <div class="pix-qr">
                    <div>QR Code PIX<br><small>Escaneie com seu banco</small></div>
                </div>
                
                <div class="pix-code" id="pixCode">
                    00020126580014BR.GOV.BCB.PIX0136best-roleplay-store@email.com52040000530398654
                </div>
                
                <button class="copy-button" onclick="copyPixCode()">
                    📋 Copiar Código PIX
                </button>
                
                <div class="payment-instructions">
                    <h4>📋 Como pagar:</h4>
                    <ol>
                        <li>Abra o app do seu banco</li>
                        <li>Escolha a opção PIX</li>
                        <li>Escaneie o QR Code ou cole o código</li>
                        <li>Confirme o pagamento</li>
                        <li>Envie o comprovante no Discord</li>
                    </ol>
                </div>
                
                <button class="buy-button" onclick="confirmPayment()" style="margin-top: 1rem;">
                    ✅ Já fiz o pagamento
                </button>
            </div>
        </div>
    </div>

    <!-- Cart -->
    <button class="cart-toggle" onclick="toggleCart()">🛒</button>
    <div class="cart" id="cart">
        <h3>Carrinho</h3>
        <div id="cartItems"></div>
        <div class="cart-total" id="cartTotal">Total: R$ 0,00</div>
        <button class="buy-button" onclick="checkout()" style="margin-top: 1rem;" ${!isLoggedIn ? 'disabled' : ''}>
            ${!isLoggedIn ? 'Faça login para finalizar' : 'Finalizar Compra via PIX'}
        </button>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 Best RolePlay. Todos os direitos reservados.</p>
        <p>Discord: Best RolePlay Community</p>
    </footer>

    <script>
        // ====== CONFIGURAÇÃO DE PRODUTOS (FÁCIL DE EDITAR) ======
        const PRODUCTS = [
            {
                id: 1,
                title: "VIP Mensal",
                description: "Acesso VIP completo por 30 dias com benefícios exclusivos",
                price: 25.00,
                icon: "👑"
            },
            {
                id: 2,
                title: "Dinheiro Virtual",
                description: "100.000 em dinheiro virtual para usar no servidor",
                price: 15.00,
                icon: "💰"
            },
            {
                id: 3,
                title: "Carro Premium",
                description: "Acesso a veículos premium exclusivos",
                price: 35.00,
                icon: "🏎️"
            },
            {
                id: 4,
                title: "Casa de Luxo",
                description: "Propriedade exclusiva em área nobre",
                price: 50.00,
                icon: "🏠"
            },
            {
                id: 5,
                title: "Kit Empresário",
                description: "Itens especiais para roleplay empresarial",
                price: 30.00,
                icon: "💼"
            },
            {
                id: 6,
                title: "Armas Especiais",
                description: "Arsenal exclusivo para membros VIP",
                price: 20.00,
                icon: "🔫"
            }
        ];

        // ====== CONFIGURAÇÃO DO DISCORD (SUBSTITUA PELOS SEUS DADOS) ======
        const DISCORD_CONFIG = {
            clientId: 'SEU_CLIENT_ID_AQUI', // Substitua pelo seu Client ID
            redirectUri: window.location.origin, // URL do seu site
            scope: 'identify email',
            apiEndpoint: 'https://discord.com/api/v10'
        };

        // Estado da aplicação
        let user = null;
        let cart = [];
        let isLoggedIn = false;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            generateProducts();
            checkAuth();
            setupDiscordLogin();
            handleDiscordCallback();
        });

        // Gerar produtos na grid
        function generateProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            PRODUCTS.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <div class="product-icon">${product.icon}</div>
                    <h3 class="product-title">${product.title}</h3>
                    <p class="product-description">${product.description}</p>
                    <div class="product-price">R$ ${product.price.toFixed(2)}</div>
                    <button class="buy-button" onclick="addToCart(${product.id})" ${!isLoggedIn ? 'disabled' : ''}>
                        ${!isLoggedIn ? 'Faça login para comprar' : 'Adicionar ao Carrinho'}
                    </button>
                `;
                grid.appendChild(productCard);
            });
        }

        // Configurar login do Discord
        function setupDiscordLogin() {
            document.getElementById('discordLogin').addEventListener('click', function() {
                initiateDiscordLogin();
            });
        }

        // Iniciar login do Discord (REAL)
        function initiateDiscordLogin() {
            if (DISCORD_CONFIG.clientId === 'SEU_CLIENT_ID_AQUI') {
                alert('⚠️ Configure o Client ID do Discord primeiro!\n\nVá para https://discord.com/developers/applications');
                return;
            }

            const params = new URLSearchParams({
                client_id: DISCORD_CONFIG.clientId,
                redirect_uri: DISCORD_CONFIG.redirectUri,
                response_type: 'code',
                scope: DISCORD_CONFIG.scope
            });

            window.location.href = `https://discord.com/api/oauth2/authorize?${params}`;
        }

        // Processar callback do Discord
        async function handleDiscordCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');

            if (code) {
                try {
                    // Mostrar loading
                    showLoading('Fazendo login com Discord...');

                    // Trocar código por token de acesso
                    const tokenData = await exchangeCodeForToken(code);
                    
                    // Buscar dados do usuário
                    const userData = await fetchDiscordUser(tokenData.access_token);
                    
                    handleLoginSuccess(userData);
                    
                    // Limpar URL
                    window.history.replaceState({}, document.title, window.location.pathname);
                    
                    hideLoading();
                } catch (error) {
                    console.error('Erro no login:', error);
                    alert('❌ Erro ao fazer login com Discord. Tente novamente.');
                    hideLoading();
                }
            }
        }

        // Trocar código por token
        async function exchangeCodeForToken(code) {
            const response = await fetch('https://discord.com/api/oauth2/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    client_id: DISCORD_CONFIG.clientId,
                    client_secret: 'SEU_CLIENT_SECRET_AQUI', // ⚠️ NUNCA EXPONHA EM PRODUÇÃO
                    grant_type: 'authorization_code',
                    code: code,
                    redirect_uri: DISCORD_CONFIG.redirectUri,
                }),
            });

            if (!response.ok) {
                throw new Error('Falha ao obter token de acesso');
            }

            return await response.json();
        }

        // Buscar dados do usuário Discord
        async function fetchDiscordUser(accessToken) {
            const response = await fetch(`${DISCORD_CONFIG.apiEndpoint}/users/@me`, {
                headers: {
                    Authorization: `Bearer ${accessToken}`,
                },
            });

            if (!response.ok) {
                throw new Error('Falha ao buscar dados do usuário');
            }

            const userData = await response.json();
            
            return {
                id: userData.id,
                username: userData.username,
                discriminator: userData.discriminator,
                avatar: userData.avatar 
                    ? `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png`
                    : '/api/placeholder/40/40',
                email: userData.email
            };
        }

        // Manipular sucesso do login
        function handleLoginSuccess(userData) {
            user = userData;
            isLoggedIn = true;
            
            document.getElementById('discordLogin').style.display = 'none';
            document.getElementById('userInfo').style.display = 'flex';
            
            // Formatar nome do usuário
            const displayName = userData.discriminator && userData.discriminator !== '0' 
                ? `${userData.username}#${userData.discriminator}`
                : userData.username;
                
            document.getElementById('userName').textContent = displayName;
            document.getElementById('userAvatar').src = userData.avatar;
            
            generateProducts(); // Regenerar produtos com botões habilitados
            updateCart(); // Atualizar carrinho
            
            // Salvar no localStorage
            localStorage.setItem('user', JSON.stringify(userData));
            localStorage.setItem('loginTime', Date.now().toString());
            
            // Mostrar sucesso
            showNotification('✅ Login realizado com sucesso!', 'success');
        }

        // Verificar autenticação
        function checkAuth() {
            const savedUser = localStorage.getItem('user');
            const loginTime = localStorage.getItem('loginTime');
            
            if (savedUser && loginTime) {
                // Verificar se o login não expirou (7 dias)
                const sevenDays = 7 * 24 * 60 * 60 * 1000;
                if (Date.now() - parseInt(loginTime) < sevenDays) {
                    handleLoginSuccess(JSON.parse(savedUser));
                } else {
                    // Login expirado
                    localStorage.removeItem('user');
                    localStorage.removeItem('loginTime');
                }
            }
        }

        // Logout
        function logout() {
            user = null;
            isLoggedIn = false;
            cart = [];
            
            document.getElementById('discordLogin').style.display = 'block';
            document.getElementById('userInfo').style.display = 'none';
            
            localStorage.removeItem('user');
            localStorage.removeItem('loginTime');
            generateProducts();
            updateCart();
            
            showNotification('👋 Logout realizado com sucesso!', 'info');
        }

        // Mostrar loading
        function showLoading(message) {
            const loading = document.createElement('div');
            loading.id = 'loading';
            loading.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                color: white;
                font-size: 1.2rem;
                backdrop-filter: blur(5px);
            `;
            loading.innerHTML = `
                <div style="text-align: center;">
                    <div style="border: 4px solid #8b45ff; border-top: 4px solid transparent; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                    ${message}
                </div>
                <style>
                    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                </style>
            `;
            document.body.appendChild(loading);
        }

        // Esconder loading
        function hideLoading() {
            const loading = document.getElementById('loading');
            if (loading) {
                loading.remove();
            }
        }

        // Mostrar notificação
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                z-index: 10000;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Adicionar ao carrinho
        function addToCart(productId) {
            if (!isLoggedIn) {
                alert('Faça login para comprar produtos!');
                return;
            }

            const product = PRODUCTS.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...product, quantity: 1});
            }

            updateCart();
        }

        // Atualizar carrinho
        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartButton = document.querySelector('.cart button');

            cartItems.innerHTML = '';
            let total = 0;

            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <span>${item.title} x${item.quantity}</span>
                    <span>R$ ${(item.price * item.quantity).toFixed(2)}</span>
                `;
                cartItems.appendChild(cartItem);
                total += item.price * item.quantity;
            });

            cartTotal.textContent = `Total: R$ ${total.toFixed(2)}`;
            
            // Atualizar botão do carrinho
            if (cartButton) {
                cartButton.disabled = !isLoggedIn;
                cartButton.textContent = !isLoggedIn ? 'Faça login para finalizar' : 'Finalizar Compra via PIX';
            }
        }

        // Toggle carrinho
        function toggleCart() {
            const cart = document.getElementById('cart');
            cart.classList.toggle('open');
        }

        // Finalizar compra
        function checkout() {
            if (!isLoggedIn) {
                alert('❌ Faça login com Discord para finalizar a compra!');
                return;
            }

            if (cart.length === 0) {
                alert('❌ Seu carrinho está vazio!');
                return;
            }

            openPaymentModal();
        }

        // Abrir modal de pagamento
        function openPaymentModal() {
            const modal = document.getElementById('paymentModal');
            const paymentItems = document.getElementById('paymentItems');
            const paymentTotal = document.getElementById('paymentTotal');
            
            paymentItems.innerHTML = '';
            let total = 0;

            cart.forEach(item => {
                const paymentItem = document.createElement('div');
                paymentItem.className = 'payment-item';
                paymentItem.innerHTML = `
                    <span>${item.icon} ${item.title} x${item.quantity}</span>
                    <span>R$ ${(item.price * item.quantity).toFixed(2)}</span>
                `;
                paymentItems.appendChild(paymentItem);
                total += item.price * item.quantity;
            });

            paymentTotal.innerHTML = `
                <div style="display: flex; justify-content: space-between;">
                    <span>Total a Pagar:</span>
                    <span>R$ ${total.toFixed(2)}</span>
                </div>
            `;

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Fechar modal de pagamento
        function closePaymentModal() {
            const modal = document.getElementById('paymentModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Copiar código PIX
        function copyPixCode() {
            const pixCode = document.getElementById('pixCode').textContent;
            navigator.clipboard.writeText(pixCode).then(() => {
                alert('✅ Código PIX copiado para a área de transferência!');
            }).catch(() => {
                alert('❌ Erro ao copiar código PIX. Copie manualmente.');
            });
        }

        // Confirmar pagamento
        function confirmPayment() {
            alert('✅ Obrigado pela compra!\n\n' +
                  '📱 Envie o comprovante no nosso Discord para receber os produtos.\n\n' +
                  '🎮 Discord: Best RolePlay Community\n' +
                  '⏰ Produtos serão entregues em até 24 horas.');
            
            cart = [];
            updateCart();
            closePaymentModal();
            toggleCart();
        }

        // Fechar carrinho ao clicar fora
        document.addEventListener('click', function(e) {
            const cart = document.getElementById('cart');
            const cartToggle = document.querySelector('.cart-toggle');
            const paymentModal = document.getElementById('paymentModal');
            
            if (!cart.contains(e.target) && !cartToggle.contains(e.target)) {
                cart.classList.remove('open');
            }
            
            // Fechar modal ao clicar fora
            if (e.target === paymentModal) {
                closePaymentModal();
            }
        });

        // Fechar modal com ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePaymentModal();
            }
        });
    </script>
</body>
</html>